---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getEntry, getCollection } from "astro:content";
import { formatDateWithComma } from "../utils/dates";

// Load content from home.md
const homeEntry = await getEntry("pages", "home");

if (!homeEntry) {
  throw new Error("Could not find home.md in src/content/pages/");
}

const { Content } = await homeEntry.render();

// Fetch entries from now, uses, and blog collections
const nowEntries = await getCollection("now");
const usesEntries = await getCollection("uses");
const blogEntries = await getCollection("blog", ({ data }) => !data.draft);
const talksEntries = await getCollection("talks");
const notesEntries = await getCollection("notes", ({ data }) => !data.draft);

// Sort to get latest entries
const latestNow = nowEntries.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
)[0];
const latestUses = usesEntries.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
)[0];

// Get latest entries for bento cards
const latestBlog = blogEntries.sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
)[0];
const latestTalk = talksEntries.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
)[0];
const latestNote = notesEntries.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
)[0];

// Create a map of slug -> lastUpdated date
const pageLastUpdated = new Map<string, Date>();
if (latestNow) {
  pageLastUpdated.set("/now", latestNow.data.date);
}
if (latestUses) {
  pageLastUpdated.set("/uses", latestUses.data.date);
}
if (latestTalk) {
  pageLastUpdated.set("/talks", latestTalk.data.date);
}
if (latestNote) {
  pageLastUpdated.set("/notes", latestNote.data.date);
}

// Extract all the data from frontmatter
const {
  name,
  tagline,
  profileImage,
  email,
  cardPhotos: rawCardPhotos,
  pageCards,
  quote,
} = homeEntry.data;

// Enhance cardPhotos with dynamic dates from page metadata
const cardPhotos = rawCardPhotos?.map((card) => {
  const pageDate = pageLastUpdated.get(card.href);
  return {
    ...card,
    date: pageDate ? formatDateWithComma(pageDate) : card.date || "Unknown",
  };
});
---

<BaseLayout
  title="Home"
  description="Personal website and digital garden"
  hideNavInitially={true}
>
  <main class="homepage">
    <!-- Hero Section -->
    <section class="hero-section" id="hero-section">
      <div class="frosted-card-homepage hero-card hero-glow">
        <div class="hero-content">
          <!-- Profile Picture -->
          {
            profileImage && (
              <div class="hero-profile">
                <img
                  src={profileImage}
                  alt={`${name || "Profile"} photo`}
                  class="hero-profile-img"
                  fetchpriority="high"
                />
              </div>
            )
          }

          <!-- Name -->
          <h1 class="hero-name">
            <span class="hero-name-wrapper">
              <span class="hero-name-full">{name}</span>
              <span class="hero-name-short">@kaygdotorg</span>
            </span>
          </h1>

          <!-- Tagline -->
          <p class="hero-tagline">
            {tagline}
          </p>
        </div>

        <!-- Card Hand (Polaroids) -->
        {
          cardPhotos && cardPhotos.length > 0 && (
            <div class="hero-cards-section" id="hero-photo-section">
              <div class="card-hand" id="card-hand">
                <div class="card-hand-inner" id="card-hand-inner">
                  {cardPhotos.map((item, index) => (
                    <a
                      href={item.href}
                      class="card-in-hand"
                      data-index={index}
                      data-position={index}
                    >
                      <div class="card-in-hand-image">
                        <img
                          src={item.src}
                          alt={item.label}
                          draggable="false"
                          loading="lazy"
                        />
                      </div>
                      <div class="card-in-hand-label">
                        <div class="card-in-hand-slug">{item.href}</div>
                        <div class="card-in-hand-date">
                          {item.date || "Dec 2024"}
                        </div>
                      </div>
                    </a>
                  ))}
                </div>
              </div>
              <p class="hero-cards-hint">
                swipe to shuffle · tap to navigate · scroll to explore
              </p>
            </div>
          )
        }
      </div>
    </section>

    <!-- Bento Grid Section - Asymmetric grid inspired by mymind.com -->
    <!-- The grid is wrapped in a container card for visual grouping -->
    <section class="bento-section">
      <div class="frosted-card-homepage bento-wrapper">
        <!-- Section header -->
        <div class="bento-header">
          <span class="bento-header-label">Explore</span>
          <h2 class="bento-header-title">A little bit about me</h2>
        </div>

        <div class="bento-grid">
          <!-- Card 1: Latest Writing (spans 2 columns - wide at top) -->
          <a
            href={latestBlog ? `/blog/${latestBlog.slug}` : "/blog"}
            class="bento-card bento-blog bento-wide"
          >
            <div class="bento-card-header">
              <span class="bento-label">Latest Writing</span>
              <h3 class="bento-title">
                {latestBlog?.data.title || "Explore my thoughts"}
              </h3>
            </div>
            {
              latestBlog && (
                <div class="bento-card-body">
                  <div class="bento-body-layout bento-body-side-by-side">
                    <div class="bento-text-side bento-text-top-align">
                      <p class="bento-text">
                        {latestBlog.data.description || "Read my latest post →"}
                      </p>
                    </div>
                    {latestBlog.data["cover-image"] && (
                      <div class="bento-image-side">
                        <div class="bento-image-container">
                          <img
                            src={
                              typeof latestBlog.data["cover-image"] === "string"
                                ? latestBlog.data["cover-image"]
                                : latestBlog.data["cover-image"].src
                            }
                            alt={latestBlog.data.title}
                            loading="lazy"
                          />
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              )
            }
            <div class="bento-icon-floating bento-icon-pencil">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"
                ></path>
                <path d="m15 5 4 4"></path>
              </svg>
            </div>
          </a>

          <!-- Card 2: Photography (tall card) -->
          <a
            href="/photography"
            class="bento-card bento-photography bento-tall"
          >
            <div class="bento-visual-container">
              <div class="bento-visual-frame photography-frame">
                <img
                  src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&q=80"
                  alt="Photography preview"
                  loading="lazy"
                />
              </div>
            </div>
            <div class="bento-meta-overlay">
              <span class="bento-label">Photography</span>
              <h3 class="bento-title-small">Moments captured</h3>
            </div>
            <div class="bento-icon-floating">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <path
                  d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"
                ></path>
                <circle cx="12" cy="13" r="4"></circle>
              </svg>
            </div>
          </a>

          <!-- Card 3: Now Page -->
          <a href="/now" class="bento-card bento-now">
            <div class="bento-card-header">
              <span class="bento-label"
                >Now <span class="pulse-dot"></span></span
              >
              <h3 class="bento-title">What I'm doing</h3>
            </div>
            <div class="bento-card-body">
              <p class="bento-excerpt">
                {
                  latestNow
                    ? `Updated ${formatDateWithComma(latestNow.data.date)}`
                    : "Current focus & interests →"
                }
              </p>
            </div>
            <div class="bento-icon-floating">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
            </div>
          </a>

          <!-- Card 4: Uses Page -->
          <a href="/uses" class="bento-card bento-uses">
            <div class="bento-visual-container">
              <div class="bento-visual-frame uses-frame">
                <img
                  src="/images/uses-bento-grid.jpeg"
                  alt="My setup preview"
                  loading="lazy"
                />
              </div>
            </div>
            <div class="bento-meta-overlay">
              <span class="bento-label">Uses</span>
              <h3 class="bento-title-small">My setup</h3>
            </div>
            <div class="bento-icon-floating">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <path
                  d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"
                ></path>
              </svg>
            </div>
          </a>

          <!-- Card 5: Talks Page -->
          <a href="/talks" class="bento-card bento-talks bento-tall">
            <div class="bento-visual-container">
              <div class="bento-visual-frame talks-frame">
                <img
                  src="/images/talks-bento-grid.jpeg"
                  alt="Talks preview"
                  loading="lazy"
                />
              </div>
            </div>
            <div class="bento-meta-overlay">
              <span class="bento-label">Talks</span>
              <h3 class="bento-title-small">Public Speaking</h3>
              <p class="bento-excerpt-overlay">
                {
                  latestTalk
                    ? `Latest: ${latestTalk.data.title}`
                    : "Conferences & presentations →"
                }
              </p>
            </div>
            <div class="bento-icon-floating">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <path d="M22 10v6M2 10v6"></path>
                <path d="M6 10h12"></path>
                <path d="m8 6 4-4 4 4"></path>
                <path d="M12 2v20"></path>
              </svg>
            </div>
          </a>

          <!-- Card 6: Notes Page -->
          <a href="/notes" class="bento-card bento-notes">
            <div class="bento-card-header">
              <span class="bento-label">Notes</span>
              <h3 class="bento-title">Digital Garden</h3>
            </div>
            <div class="bento-card-body">
              <p class="bento-excerpt">
                {
                  latestNote
                    ? `Latest: ${latestNote.data.title}`
                    : "Fragments & thoughts →"
                }
              </p>
            </div>
            <div class="bento-icon-floating">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
              >
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
              </svg>
            </div>
          </a>
        </div>
      </div>
    </section>
  </main>

  <!-- Card Hand Swipe Script -->
  <script>
    const cardHand = document.getElementById("card-hand");
    const cards = document.querySelectorAll(
      ".card-in-hand",
    ) as NodeListOf<HTMLElement>;

    if (cardHand && cards.length > 0) {
      const numCards = cards.length;
      let currentOffset = 0;
      let isDragging = false;
      let hasMoved = false;
      let startX = 0;
      let currentX = 0;
      let dragThreshold = 50;
      let tapThreshold = 10;

      function updateCardPositions() {
        cards.forEach((card, index) => {
          let posIndex = (index - currentOffset + numCards) % numCards;
          card.setAttribute("data-position", posIndex.toString());
        });
      }

      function handleCardStart(e: MouseEvent | TouchEvent) {
        isDragging = true;
        hasMoved = false;
        startX = "touches" in e ? e.touches[0].clientX : e.clientX;
        currentX = startX;
        e.stopPropagation();
      }

      function handleCardMove(e: MouseEvent | TouchEvent) {
        if (!isDragging) return;
        currentX = "touches" in e ? e.touches[0].clientX : e.clientX;

        if (Math.abs(currentX - startX) > tapThreshold) {
          hasMoved = true;
        }
      }

      function handleCardEnd() {
        if (!isDragging) return;
        isDragging = false;

        const deltaX = currentX - startX;

        if (Math.abs(deltaX) > dragThreshold) {
          if (deltaX < 0) {
            currentOffset = (currentOffset + 1) % numCards;
          } else {
            currentOffset = (currentOffset - 1 + numCards) % numCards;
          }
          updateCardPositions();
        }
      }

      cards.forEach((card) => {
        card.addEventListener("click", (e) => {
          if (hasMoved) {
            e.preventDefault();
            e.stopPropagation();
          }
          hasMoved = false;
        });

        card.addEventListener("mousedown", handleCardStart);
        card.addEventListener("touchstart", handleCardStart, {
          passive: false,
        });
      });

      cardHand.addEventListener("mousedown", handleCardStart);
      cardHand.addEventListener("touchstart", handleCardStart, {
        passive: false,
      });

      document.addEventListener("mousemove", handleCardMove);
      document.addEventListener("mouseup", handleCardEnd);
      document.addEventListener("touchmove", handleCardMove, { passive: true });
      document.addEventListener("touchend", handleCardEnd);

      // Horizontal scroll/wheel to shuffle cards
      let wheelTimeout: ReturnType<typeof setTimeout> | null = null;
      let accumulatedDelta = 0;
      const wheelThreshold = 50;

      cardHand.addEventListener(
        "wheel",
        (e: WheelEvent) => {
          const delta =
            Math.abs(e.deltaX) > Math.abs(e.deltaY) ? e.deltaX : e.deltaY;

          e.stopPropagation();
          accumulatedDelta += delta;

          if (wheelTimeout) clearTimeout(wheelTimeout);

          if (Math.abs(accumulatedDelta) > wheelThreshold) {
            if (accumulatedDelta > 0) {
              currentOffset = (currentOffset + 1) % numCards;
            } else {
              currentOffset = (currentOffset - 1 + numCards) % numCards;
            }
            updateCardPositions();
            accumulatedDelta = 0;
          }

          wheelTimeout = setTimeout(() => {
            accumulatedDelta = 0;
          }, 150);
        },
        { passive: true },
      );

      updateCardPositions();
    }

    // Scroll-Aware Navigation Logic
    // Wrapped in a function so it can run on initial load AND on View Transitions
    function initNavScrollObserver() {
      const heroSection = document.getElementById("hero-section");
      const navContainer = document.getElementById("nav-container");
      const blurOverlay = document.getElementById("navbar-blur");

      if (heroSection && navContainer) {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (!entry.isIntersecting) {
                // Hero is out of view (scrolled past) -> Show Nav & Blur
                navContainer.classList.remove("nav-hidden");
                navContainer.classList.add("nav-visible");
                blurOverlay?.classList.remove("blur-hidden");
              } else {
                // Hero is in view -> Hide Nav & Blur
                navContainer.classList.remove("nav-visible");
                navContainer.classList.add("nav-hidden");
                blurOverlay?.classList.add("blur-hidden");
              }
            });
          },
          {
            root: null,
            threshold: 0,
            rootMargin: "-100px 0px 0px 0px", // Trigger slightly before hero completely leaves
          },
        );

        observer.observe(heroSection);
      }
    }

    // Initialize
    initNavScrollObserver();

    // Re-initialize on page load (View Transitions)
    document.addEventListener("astro:page-load", () => {
      initNavScrollObserver();
    });
  </script>

  <style>
    /* Homepage Layout */
    .homepage {
      display: flex;
      flex-direction: column;
      gap: 4rem;
      padding: 0; /* Remove padding to allow hero to fill screen */
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Hero Section - Full viewport, centered */
    .hero-section {
      min-height: 100vh;
      min-height: 100dvh; /* Dynamic viewport height for mobile */
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .hero-card {
      padding: 3rem;
      max-width: 600px;
      width: 100%;
      text-align: center;
    }

    .hero-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .hero-profile {
      width: 8rem;
      height: 8rem;
      border-radius: 50%;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .hero-profile-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .hero-name {
      font-family: var(--font-heading, "Playfair Display", Georgia, serif);
      font-size: 3rem;
      font-weight: 400;
      line-height: 1.1;
      letter-spacing: -0.07em;
    }

    .hero-name-wrapper {
      position: relative;
      display: inline-block;
      color: var(--color-base-content, inherit);
    }

    .hero-name-full,
    .hero-name-short {
      display: block;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hero-name-short {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      opacity: 0;
      transform: translateY(10px);
      white-space: nowrap;
      font-size: 0.85em;
      letter-spacing: normal;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }

    /* Desktop Hover - Name Swap */
    @media (min-width: 1024px) {
      .hero-card:hover .hero-name-full {
        opacity: 0;
        transform: translateY(-8px);
      }
      .hero-card:hover .hero-name-short {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Mobile - Subtle premium transition (slower) */
    @media (max-width: 1023px) {
      .hero-name-full {
        animation: mobile-name-fade 12s ease-in-out infinite;
      }
      .hero-name-short {
        animation: mobile-short-fade 12s ease-in-out infinite;
      }
    }

    @keyframes mobile-name-fade {
      0%,
      45%,
      100% {
        opacity: 1;
        transform: translateY(0);
      }
      50%,
      95% {
        opacity: 0;
        transform: translateY(-8px);
      }
    }

    @keyframes mobile-short-fade {
      0%,
      45%,
      100% {
        opacity: 0;
        transform: translateY(8px);
      }
      50%,
      95% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .hero-glow {
      box-shadow:
        0 0 60px rgba(236, 72, 153, 0.08),
        0 0 120px rgba(236, 72, 153, 0.08),
        0 4px 30px rgba(0, 0, 0, 0.1);
    }

    /* Pulsing dot for Now card */
    .pulse-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
      margin-left: 0.5rem;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%,
      100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.5;
        transform: scale(1.2);
      }
    }

    @media (min-width: 768px) {
      .hero-name {
        font-size: 4rem;
      }
    }

    .hero-tagline {
      font-size: 1.125rem;
      color: var(--color-base-content, inherit);
      opacity: 0.8;
      max-width: 400px;
      line-height: 1.6;
    }

    .hero-cards-section {
      margin-top: 1rem;
    }

    .hero-cards-hint {
      text-align: center;
      font-size: 0.875rem;
      color: var(--color-base-content, inherit);
      opacity: 0.6;
      margin-top: 1rem;
    }

    /* ============================================
     * Bento Grid Section
     * Asymmetric grid wrapped in a container card
     * Layout: Writing (wide at top), Photo (tall right),
     *         Now + Uses (stacked on left bottom)
     * ============================================ */
    .bento-section {
      padding: 0 2rem 6rem;
      display: flex;
      justify-content: center;
    }

    /* Wrapper card - uses the same glassmorphism as hero */
    .bento-wrapper {
      padding: 3rem;
      max-width: 1400px;
      width: 100%;
    }

    /* Section header inside wrapper */
    .bento-header {
      margin-bottom: 3.5rem;
      text-align: center;
    }

    .bento-header-label {
      font-size: 1rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--color-accent-500, #ec4899);
      display: block;
      margin-bottom: 0.75rem;
    }

    .bento-header-title {
      font-family: var(--font-heading, "Playfair Display", Georgia, serif);
      font-size: 3.5rem;
      font-weight: 400;
      letter-spacing: -0.04em;
      line-height: 1.1;
      color: var(--color-base-content, inherit);
    }

    /* Grid layout - 2 columns with named grid areas for asymmetry */
    .bento-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: minmax(380px, auto) minmax(280px, auto) minmax(
          320px,
          auto
        );
      grid-template-areas:
        "blog  blog"
        "now      photo"
        "uses     photo"
        "talks    notes";
      gap: 1.5rem;
    }

    /* Base card styles - LARGER cards like mymind.com */
    .bento-card {
      position: relative;
      border-radius: 2rem;
      padding: 2.5rem;
      min-height: 280px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      text-decoration: none;
      overflow: hidden;
      transition:
        transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1),
        box-shadow 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    .bento-card:hover {
      transform: translateY(-4px) scale(1.01);
      box-shadow: 0 16px 40px -12px rgba(0, 0, 0, 0.25);
    }

    /* Grid area assignments */
    .bento-blog {
      grid-area: blog;
    }
    .bento-photography {
      grid-area: photo;
    }
    .bento-now {
      grid-area: now;
    }
    .bento-uses {
      grid-area: uses;
    }
    .bento-talks {
      grid-area: talks;
    }
    .bento-notes {
      grid-area: notes;
      min-height: 400px;
    }

    /* Varied heights for visual interest */
    .bento-blog {
      min-height: 380px;
    }

    .bento-now,
    .bento-uses {
      min-height: 240px;
    }

    .bento-photography,
    .bento-talks {
      min-height: 520px;
    }

    /* Wide card - Writing with extra padding */
    .bento-wide {
      min-height: 280px;
      padding: 3rem;
      grid-column: span 2;
    }

    /* Tall card - Photography spans 2 rows, much taller */
    .bento-tall {
      min-height: 660px;
    }

    /* Card content layout */
    .bento-card-content {
      position: relative;
      z-index: 1;
    }

    .bento-label {
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      opacity: 0.7;
      margin-bottom: 0.75rem;
      display: block;
    }

    .bento-title {
      font-family: var(--font-heading, "Playfair Display", Georgia, serif);
      font-size: 2.25rem;
      font-weight: 500;
      line-height: 1.1;
      margin: 0.75rem 0;
      letter-spacing: -0.03em;
    }

    .bento-text {
      font-size: 1.15rem;
      opacity: 0.75;
      margin-top: 1rem;
      line-height: 1.6;
    }

    /* Bento Card Body Layouts */
    .bento-body-layout {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      flex: 1;
    }

    @media (min-width: 1024px) {
      .bento-body-side-by-side {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }

      .bento-body-side-by-side .bento-text-side {
        flex: 1;
        max-width: 65%;
      }

      .bento-body-side-by-side .bento-image-side {
        flex: 1;
        max-width: 35%;
        display: flex;
        justify-content: flex-end;
      }
    }

    .bento-image-container {
      width: 100%;
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
      aspect-ratio: 4/3;
    }

    .bento-card:hover .bento-image-container {
      transform: scale(1.05) rotate(2deg);
    }

    .bento-image-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .bento-subtitle {
      font-size: 1.1rem;
      margin-top: 0.5rem;
    }

    /* Icon positioned in corner - larger */
    .bento-icon {
      position: absolute;
      bottom: 1.5rem;
      right: 1.5rem;
      opacity: 0.25;
      transition:
        opacity 0.3s ease,
        transform 0.3s ease;
    }

    .bento-icon svg {
      width: 36px;
      height: 36px;
    }

    .bento-card:hover .bento-icon {
      opacity: 0.5;
      transform: scale(1.1);
    }

    /* ============================================
     * Individual Card Colors - Light Mode
     * Coordinated palette matching mymind.com
     * ============================================ */

    /* Blog card - Soft peach */
    .bento-blog {
      background: #fdf2f0;
      color: #5a3d3d;
    }

    /* Photography card - Soft mint */
    .bento-photography {
      background: #f0f7f4;
      color: #3d5a4d;
    }

    /* Now card - Soft cream/yellow */
    .bento-now {
      background: #fcf9ee;
      color: #5a543d;
    }

    /* Uses card - Soft lavender/muted tan */
    .bento-uses {
      background: #f6f0f7;
      color: #4d3d5a;
    }

    /* Talks card - Soft blue/grey */
    .bento-talks {
      background: #f0f4f7;
      color: #3d4d5a;
    }

    /* Notes card - Soft sage/green */
    .bento-notes {
      background: #f4f6f0;
      color: #4d5a3d;
    }

    /* ============================================
     * Individual Card Colors - Dark Mode
     * Muted, desaturated versions
     * ============================================ */
    :root[data-theme="dark"] .bento-blog {
      background: #2a1f1e;
      color: #e0cccc;
    }

    :root[data-theme="dark"] .bento-photography {
      background: #1e2a24;
      color: #cce0d6;
    }

    :root[data-theme="dark"] .bento-now {
      background: #2a291e;
      color: #e0decc;
    }

    :root[data-theme="dark"] .bento-uses {
      background: #241e2a;
      color: #d6cce0;
    }

    :root[data-theme="dark"] .bento-talks {
      background: #1e242a;
      color: #ccd6e0;
    }

    :root[data-theme="dark"] .bento-notes {
      background: #242a1e;
      color: #d6e0cc;
    }

    /* ============================================
     * Visual Framing & Content Styles
     * The "framed object on color" look
     * ============================================ */
    .bento-visual-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem 0;
      perspective: 1000px;
    }

    .bento-visual-frame {
      position: relative;
      width: 92%;
      height: 220px;
      border-radius: 1.25rem;
      background: white;
      box-shadow:
        0 15px 45px -10px rgba(0, 0, 0, 0.15),
        0 10px 20px -10px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      transform: rotateX(4deg) rotateY(-4deg);
      transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    .bento-card:hover .bento-visual-frame {
      transform: rotateX(0deg) rotateY(0deg) scale(1.08);
      box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.2);
    }

    .bento-visual-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .photography-frame {
      height: 480px;
      width: 95%;
    }

    .uses-frame {
      height: 280px;
      width: 94%;
    }

    .talks-frame {
      height: 220px;
      width: 92%;
    }

    .talks-frame img {
      object-position: 0% 80%;
    }

    /* Card Text Elements */
    .bento-card-header,
    .bento-card-body {
      position: relative;
      z-index: 2;
    }

    .bento-meta-overlay {
      margin-top: auto;
      padding-top: 1rem;
    }

    .bento-title-small {
      font-family: var(--font-heading, "Playfair Display", Georgia, serif);
      font-size: 1.1rem;
      font-weight: 500;
      margin-top: 0.25rem;
    }

    .bento-excerpt-overlay {
      font-size: 0.85rem;
      opacity: 0.8;
      margin-top: 0.5rem;
      line-height: 1.4;
    }

    .bento-icon-floating {
      position: absolute;
      top: 2rem;
      right: 2rem;
      opacity: 0.2;
      transition: opacity 0.3s ease;
    }

    .bento-card:hover .bento-icon-floating {
      opacity: 0.4;
    }

    /* Top-align text for Latest Writing card on wider layouts */
    @media (min-width: 768px) {
      .bento-text-top-align {
        align-self: flex-start;
      }
    }

    /* ============================================
     * Responsive Design
     * Stack cards vertically on mobile
     * ============================================ */
    @media (max-width: 640px) {
      .bento-section {
        padding: 0 0.5rem 4rem;
      }

      .bento-wrapper {
        padding: 0.75rem;
      }

      .bento-header {
        margin-bottom: 2rem;
        padding-top: 1.5rem;
      }

      .bento-header-title {
        font-size: 2.25rem;
      }

      .bento-grid {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        width: 100%;
      }

      .bento-card {
        width: 100%;
        min-height: 120px;
        padding: 1.25rem;
      }

      .bento-tall {
        min-height: 200px;
      }

      .bento-title {
        font-size: 1.6rem;
      }

      .bento-text {
        font-size: 1rem;
        line-height: 1.5;
      }

      .bento-icon-pencil svg {
        width: 18px;
        height: 18px;
      }

      .bento-icon-floating {
        top: 1.25rem;
        right: 1.25rem;
      }

      /* Position icons at bottom right for Photography, Uses, and Talks cards to avoid collision with images */
      .bento-photography .bento-icon-floating,
      .bento-uses .bento-icon-floating,
      .bento-talks .bento-icon-floating {
        top: auto;
        bottom: 1.25rem;
      }
    }

    /* Footer Section */
    .footer-section {
      padding: 4rem 0 8rem;
      display: flex;
      justify-content: center;
    }

    .footer-card {
      padding: 3rem;
      max-width: 600px;
      text-align: center;
    }

    .footer-quote {
      font-family: var(--font-heading, "Playfair Display", Georgia, serif);
      font-size: 1.5rem;
      font-style: italic;
      color: var(--color-base-content, inherit);
      opacity: 0.8;
      line-height: 1.4;
      letter-spacing: -0.02em;
    }

    .footer-cta {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 2rem;
      color: var(--color-accent, #ec4899);
      font-size: 1rem;
      text-decoration: none;
      transition: gap 0.3s ease;
    }

    .footer-cta:hover {
      gap: 1rem;
    }

    .footer-cta svg {
      width: 1.25rem;
      height: 1.25rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .homepage {
        padding: 1rem;
        gap: 3rem;
      }

      .hero-section {
        flex: 1;
      }

      .hero-card {
        padding: 2rem;
      }

      .hero-name {
        font-size: 2.75rem;
      }

      .hero-profile {
        width: 6rem;
        height: 6rem;
      }
    }
  </style>
</BaseLayout>
