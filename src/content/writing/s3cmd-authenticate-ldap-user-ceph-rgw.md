---
date: 2024-10-28 16:00
last edited: 2025-01-05 19:06
tags:
  - ceph
  - ceph/rgw
  - linux/ldap
  - ceph/s3
  - s3cmd
title: S3CMD Authenticate as a LDAP User with Ceph RGW
---
## â“ What?

To authenticate to a LDAP server as a RGW user, the ceph docs instruct one to use the token generated with `radosgw-token --encode` as the access key when used with AWS CLI. 

However, when using s3cmd, two changes have to be made:

- `--access_token` needs to be used instead of `--access_key`
- `--signature-v2` needs to be specified 

An example command might look like:
```
s3cmd --access_token=<access-token-from-radosgw-token> --signature-v2 s3://<host>:<port>/<bucket> ls
```

## ğŸ“š References

```
# export AWS_ACCESS_KEY_ID=<base64-encoded token generated by radosgw-token>
# export AWS_SECRET_ACCESS_KEY="" # define this with an empty string, otherwise tools might complain about missing env variables.
```
-- https://docs.ceph.com/en/reef/radosgw/ldap-auth/#using-the-access-token

```
Â Â --signature-v2Â Â Â Â Â Â Â Â UseÂ AWSÂ SignatureÂ versionÂ 2Â insteadÂ ofÂ newerÂ signature  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methods.Â HelpfulÂ forÂ S3-likeÂ systemsÂ thatÂ don'tÂ have  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AWSÂ SignatureÂ v4Â yet.
```
-- https://s3tools.org/usage

https://github.com/s3tools/s3cmd/issues/1065